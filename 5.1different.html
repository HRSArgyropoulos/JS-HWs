<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>#5 Functions</title>
</head>

<body>
    <script>
        "use strict";

        /* Bugs[Fixed]: 1) [Fixed] When max on the last position(-although the code is not very clean (possibly sone nested ifs can be avoided-) 
        2) [Fixed] When input only one word 
        3) [Fixed] When input is " " (space) */

        /*Optimization: I could add " " in the end of array so we do not have a if (situation for the last element)*/

        const longestWords = (positions, sentence) => {
            let words = [];
            for (const pos of positions[0]) { // where the position indexes are
                let word = "";
                for (let i = 0; i < positions[1]; i++) { // where the max characters of word counter is
                    word += sentence[pos + i]; 
                }
                words.push(word,pos+1); //more user friendly the n-nth position not index
            }
            return words;
        };

        const longestWordsPositions = (str) => {
            //we save positions so we do not have to generate the word every time and we ll do it in longestWords function only for the max words to improve code efficiency 
            let maxWordCount = 0;
            let wordCount = 0;
            let positions = []; //array of max positions
            let curPos = 0; //the starting index of the current word
            for (let i=0; i<str.length; i++) {
                if (str[i] === ' ' || i===str.length-1) { //space between words
                    if (i===str.length-1) {wordCount++;} //for last element stop the wordcounting (end the word) -> see optimization
                    if (wordCount >= maxWordCount) {
                        if (wordCount > maxWordCount) { positions = []; } //empty array as we have a new max
                        maxWordCount = wordCount;
                        positions.push(curPos);
                    }
                    curPos += wordCount + 1; //previous position + this max word length + space character
                    wordCount = 0;
                } else { wordCount++; }
            }
            return [positions, maxWordCount]; //2 dimensional array. first we have an array of the position and then we have the length of the max word(s) | objects/record collection more suitable here(?)
        };

        const userInput = () => {
            let input;
            let flag;
            let spaceCounter=-1; // if 0 then if empty string was inputted "" then it would return the input as "".length = 0 spacecounter=0
            while (true) {
                input = prompt('Enter a phrase');
                if (input[0]===" ") { //if it does not begin with space it wont be empty so no point of checking every character for spaces
                    spaceCounter=0;
                    for (const char of input) {
                        if (char===" ") spaceCounter++;
                    }
                }
                if (input && spaceCounter!=input.length) { return input; }
            }
        };

        const input = userInput(); 
        const positions = longestWordsPositions(input);
        console.log("Positions", positions[0]);
        const words = longestWords(positions, input);
        console.log("Words", words);
    </script>
</body>

</html>